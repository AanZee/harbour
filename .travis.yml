language: node_js

node_js:
- '8'
- '10'

before_install:
- rvm install 2.5.1

install:
- bundle install
- pip install --user awscli
- npm install
- npm install -g gulp-cli

jobs:
  include:
  - stage: Test
    script: npm run build
  - stage: Deploy
    if: type = push
    node_js: '10'
    deploy:
    - provider: script
      on:
        branch: feature/HAR-161-s3-deployments # TODO: change to master
      script: bash scripts/deploy-master.sh
